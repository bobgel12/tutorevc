{
  "_args": [
    [
      {
        "raw": "express-flash-notification@^0.4.0",
        "scope": null,
        "escapedName": "express-flash-notification",
        "name": "express-flash-notification",
        "rawSpec": "^0.4.0",
        "spec": ">=0.4.0 <0.5.0",
        "type": "range"
      },
      "/Users/bobgel/Documents/TutorWebsite/tutorapp"
    ]
  ],
  "_from": "express-flash-notification@>=0.4.0 <0.5.0",
  "_id": "express-flash-notification@0.4.0",
  "_inCache": true,
  "_location": "/express-flash-notification",
  "_nodeVersion": "0.12.0",
  "_npmUser": {
    "name": "ascari",
    "email": "carlos.ascari.x@gmail.com"
  },
  "_npmVersion": "2.5.1",
  "_phantomChildren": {},
  "_requested": {
    "raw": "express-flash-notification@^0.4.0",
    "scope": null,
    "escapedName": "express-flash-notification",
    "name": "express-flash-notification",
    "rawSpec": "^0.4.0",
    "spec": ">=0.4.0 <0.5.0",
    "type": "range"
  },
  "_requiredBy": [
    "/"
  ],
  "_resolved": "https://registry.npmjs.org/express-flash-notification/-/express-flash-notification-0.4.0.tgz",
  "_shasum": "c199e88140a54b6e7a0a692a473fd67469d2a960",
  "_shrinkwrap": null,
  "_spec": "express-flash-notification@^0.4.0",
  "_where": "/Users/bobgel/Documents/TutorWebsite/tutorapp",
  "author": {
    "name": "Ascari Gutierrez Hermosillo",
    "email": "carlos.ascari.x@gmail.com"
  },
  "bugs": {
    "url": "https://github.com/carlosascari/express-flash-notification/issues"
  },
  "dependencies": {
    "async": "^0.9.0"
  },
  "description": "Express.js flash notifications that works with any template engine",
  "devDependencies": {},
  "directories": {},
  "dist": {
    "shasum": "c199e88140a54b6e7a0a692a473fd67469d2a960",
    "tarball": "https://registry.npmjs.org/express-flash-notification/-/express-flash-notification-0.4.0.tgz"
  },
  "gitHead": "b1c5b2d26b1e80eea374c2c71026b5a2512478a3",
  "homepage": "https://github.com/carlosascari/express-flash-notification#readme",
  "keywords": [
    "flash",
    "flash message",
    "flash notification",
    "notification",
    "express",
    "hogan",
    "mustache",
    "logicless"
  ],
  "license": "MIT",
  "main": "index.js",
  "maintainers": [
    {
      "name": "ascari",
      "email": "carlos.ascari.x@gmail.com"
    }
  ],
  "name": "express-flash-notification",
  "optionalDependencies": {},
  "readme": "# express-flash-notification\r\n\r\nThis module provides a way to set one-time notifications to be displayed during or after processing a request. Notifications are stored in session and are removed once they have been rendered.\r\n\r\n**Key Points**\r\n\r\n- **Template Engine Agnostic**, works with any engine you are using logic/logicless.\r\n- Supports for **Multiple notifications** to be sent.\r\n- **Auto refreshes or redirects** the page to display the notification.\r\n- Allows you to manipulate the notification output **before and after** it has been created.\r\n- **No need to refresh or redirect**, notifications can be rendered on the same request.\r\n\r\n### Why?\r\n\r\n`connect-flash` is nice if your template engine can do some conditional logic like EJS however,  if you are using a logic-less engine, like `hogan-express` things get akward IMO.\r\n\r\nI needed something simple like: \r\n\r\n`req.flash('info', 'my message')` \r\nin my controller/middleware and\r\n\r\n`{{{flash}}}` \r\nin my layout\r\n\r\nThen the HTML for each alert gets placed in `{{{flash}}}` including some client side javascript so it doesn't just appear `$(elm).slideDown()` **FTW**\r\n\r\nWhile at the same time, adding the markup nessary to display the alert depending on its **type** (so *info* is blue, *error* is red, etc).\r\n\r\n## Install\r\n```\r\nnpm install express-flash-notification --save\r\n```\r\n## Usage\r\n\r\nFlash notifications are stored in the session. You will need the `cookieParser` middleware and the `session` middleware. Depending on your express version it may be bundled in express  or for the newer releases you'll have to npm install them as seperate modules. I'm using express 4.x in the following examples.\r\n\r\nYou must pass the express application instance as the first argument in  the `flash()` middleware so `app.render` can be used to create your notification using your chosen template engine and views directory.\r\n\r\n```javascript\r\nvar flash \t\t\t= require('express-flash-notification')\r\nvar cookieParser\t= require('cookie-parser')\r\nvar session\t\t\t= require('express-session')\r\n\r\nvar app = express()\r\n\r\n// setup views directory, view engine, etc...\r\n\r\napp.use(cookieParser())\r\napp.use(session({...}}))\r\napp.use(flash(app))\r\n```\r\n\r\n##### In your Layout\r\n\r\nWherever you place the local variable `flash`, it will be populated with the notifications if there are any. Make sure it does not escape, as the output *may* be HTML.\r\n\r\n```html\r\n<<!DOCTYPE html>\r\n<html>\r\n<head>\r\n\t<title></title>\r\n</head>\r\n<body>\r\n\t{{{flash}}}\r\n</body>\r\n</html>\r\n```\r\n\r\n##### In your Views\r\n\r\nBy default, a view called `flash` in your `views` directory will be retrieved and used as the default template for your notifications.\r\nThe local variables `type` and `message` will be set, depending on the type and message passed when calling **req.render**\r\n\r\n**flash.html** (I'm using mustache in this example)\r\n\r\n```html\r\n<div class=\"alert flash\">\r\n\t<button type=\"button\" class=\"close\">Ã—</button>\r\n\t<i class=\"fa sign\"></i><strong>{{type}}</strong> \r\n\t<span>{{message}}</span>\r\n</div>\r\n```\r\n\r\n\r\n### req.flash API\r\n\r\n**Note** A `notification` is an object where its properties become the local variables when rendering the it using the express rendering engine of your choice.\r\n\r\n- **req.flash**(*String*)\r\n  Sets local variable `message` to the string provided, `type` will become an empty string. Will refresh the current page.\r\n\r\n- **req.flash**(*String*, *String*)\r\n  First string is the `type` local variable, the second is the `message` local variable. Will refresh the current page.\r\n\r\n- **req.flash**(*String*, *String*, *String*)\r\n  Similar to to above, except last argument as a string defines which page to redirect to.\r\n\r\n- **req.flash**(*String*, *String*, *Boolean*)\r\n  Same as above. Third variable as a boolean decides whether or not to refresh the page.\r\n  **NOTE** If set to false, notification will not be rendered until the next request. If you want the notification to be rendered on the current request, you can use a function that is returned by `req.flash`, simply call the function with a callback, the callback will be executed once rendering is complete. \r\n  \r\n    **example**\r\n  \t```\r\n  \tapp.all(function SampleExpressRoute(req, res){\r\n  \t\tvar manualRender = req.flash('warn', 'tell them now!', false)\r\n  \t\tmanualRender(function(err){\r\n  \t\t\tif (err) throw err\r\n  \t\t\tres.render('layouts/internal')\r\n  \t\t})\r\n  \t})\r\n  \t```\r\n\r\n- **req.flash**(*object*)\r\n  You can pass an object as the first argument, the object's properties will be exposed as local variables when rendering the notification template.\r\n  The property `redirect` is reserved and functions just as you'd expect; a *Boolean* determines if it will refresh, or as a *String* you specify where to redirect to.\r\n  ```javascript\r\n  req.flash('info', 'if cats ruled the world', false)\r\n  ``` \r\n  is treated exactly the same as:\r\n  ```javascript\r\n  req.flash({\r\n    type: 'info',\r\n    message: 'if cats rules the world',\r\n    redirect: false\r\n  })\r\n  ```\r\n\r\n### Usage Example\r\n\r\nWith the `flash` middleware in place, all requests will have a `req.flash()` method to send out flash notifications.\r\n\r\n```javascript\r\napp.use('/login', function loginProcessor(req, res, next){\r\n\tif (req.method !== 'POST') return next()\r\n\tif (!req.body) return next(new Error('no data was sent to the server, please try again'))\r\n\t\r\n\tvar user = req.body.user\r\n\tvar pass = req.body.pass\r\n\r\n\tif (user && pass)\r\n\t{\r\n\t\tif (user === 'root' && pass === 'toor')\r\n\t\t{\r\n\t\t\tres.redirect('/dashboard')\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\treq.flash('info', 'invalid username or password')\r\n\t\t}\r\n\t}\r\n\telse\r\n\t{\r\n\t\treq.flash('info', 'you must enter your username and password to login')\r\n\t}\r\n})\r\n\r\napp.use('/login', function loginErrorHandler(err, req, res, next){\r\n\tif (err.message)\r\n\t{\r\n\t\treq.flash('error', err.message)\r\n\t}\r\n\telse\r\n\t{\r\n\t\tconsole.log('there was a nasty login error: %s', err.stack)\r\n\t\tnext()\r\n\t}\r\n})\r\n\r\napp.get('/login', function loginRenderer(req, res, next){\r\n\tres.render('external', {\r\n\t\tpartials: {\r\n\t\t\tcontent: 'external/login'\r\n\t\t}\r\n\t})\t\r\n})\r\n```\r\n\r\n###### Pitfalls \r\n\r\nBy default, **req.flash** will redirect to the current url, effectively refreshing the page so to display the flash notification. It is important that your logic uses `return` when using flash or conditioning so you don't get the *headers have already been sent* error. \r\n\r\nFor example below, if 2 + 2 ever equals 'fish' the `req.flash` method will send out the redirect headers, and execution will continue until the `next` function is called, `next` will also try to set the response headers\r\n\r\n```javascript\r\napp.use('/get-busy', function(req, res, next){\r\n \tif (2 + 2 === 'fish')\r\n \t{\r\n \t\treq.flash('error', 'fairies!')\r\n \t}\r\n\t\r\n \t// ... other logics go here\r\n \tnext()\r\n})\r\n```\r\n\r\nIn the case above, and in case you want to send multiple notifications you can disable the redirect by setting the third parameter to `false`\r\n\r\n```javascript\r\napp.use('/get-busy', function(req, res, next){\r\n \tif (2 + 2 === 'fish')\r\n \t{\r\n \t\treturn req.flash('error', 'fairies!', '/impossible')\r\n \t}\r\n\t\r\n \t// ... other logics go here\r\n \treq.flash('success', 'logics are done', false)\r\n \tnext()\r\n})\r\n```\r\n\r\n----------------\r\n\r\n## Advance Configuration\r\n\r\nWhen setting the flash middleware, the second parameter accepts an object for configuration.\r\nBelow is an example with all the options set to their defaults\r\n\r\n```javascript\r\napp.use(flash(app, {\r\n\tsession_name: \t'flash',\r\n\tutility_name: \t'flash',\r\n\tlocals_name: \t'flash',\r\n\tview_name: \t\t'flash',\r\n\tbeforeSingleRender: function(item, callback){callback(null, item)},\r\n\tafterAllRender: function(htmlFragments, callback){callback(null, htmlFragments.join('\\n'))}\r\n}))\r\n```\r\n\r\n- **session_name** Is the key used to store the notifications in session: `req.session[session_name]`\r\n\r\n- **utility_name** Is the name of the function that is exposed in the `req` object, the one used to add new notifications: `req[utility_name]('info', 'hello')`\r\n\r\n- **locals_name** Is the `locals` variable name where all your notifications will be placed, make sure it does not escape HTML: `{{{locals_name}}}`\r\n\r\n- **view_name** Is the name of the view that will be used as the template for all notifications: `app/views/view_name.html`\r\n\r\n- **beforeSingleRender** Is called right before each notification is rendered, allowing you to add/remove or modify the local variables passed to the renderer.\r\nThe first argument is an object with all the locals variables set, typically you will find `item.type` and `item.message` here. The second argument is a callback that must be called with `null` or an `Error` for the first parameter, and an object with the locals used to render on the second parameter.\r\n\r\n- **afterAllRender** Is called after all notifications have been compiled. Allowing you to append anything like extra HTML to the output.\r\nThe first argument, is an array with each rendered notification. The second argument is a callback that must be called with `null` or an `Error` for the first parameter, and the resulting notifications output **not as an Array but as a String** (Array.join)\r\n\r\n-----------------\r\n\r\n## Advance Usage\r\n\r\nHeres an example where custom notifications will be rendered, `beforeSingleRender` is used to add class names depending on the `type` of notification so the resulting notification looks different depending on its type. Also, `afterAllRender` will be used to append some javascript so notification don't just appear, they slide into view.\r\n\r\n**NOTE** `{{{flash}}}` is placed in my layout, not shown here\r\n\r\nThis is my `flash.html` view template.\r\n`alert_class` and `icon_class` will be populated inside of `beforeSingleRender`\r\n`style=\"display: none\"` is set so the appended javascript uses jQuery's `slideDown` method to animate its presentation\r\n\r\n```html\r\n<div class=\"alert flash {{alert_class}}\" style=\"display:none\">\r\n\t<button type=\"button\" class=\"close\">Ã—</button>\r\n\t<i class=\"fa {{icon_class}} sign\"></i><strong>{{type}}</strong> \r\n\t<span>{{{message}}}</span>\r\n</div>\r\n```\r\n\r\nThis is the setup\r\n\r\n```javascript\r\n\r\napp.use(require('express-flash-notification')(app, {\r\n\tview_name: \t\t'elements/flash',\r\n\tbeforeSingleRender: function(notification, callback)\r\n\t{\r\n\t\tif (notification.type)\r\n\t\t{\r\n\t\t\tswitch(notification.type)\r\n\t\t\t{\r\n\t\t\t\tcase 'error':\r\n\t\t\t\t\tnotification.alert_class = 'alert-danger'\r\n\t\t\t\t\tnotification.icon_class = 'fa-times-circle'\r\n\t\t\t\tbreak;\r\n\t\t\t\tcase 'alert':\r\n\t\t\t\t\tnotification.alert_class = 'alert-warning'\r\n\t\t\t\t\tnotification.icon_class = 'fa-times-circle'\r\n\t\t\t\tbreak;\r\n\t\t\t\tcase 'info':\r\n\t\t\t\t\tnotification.alert_class = 'alert-info'\r\n\t\t\t\t\tnotification.icon_class = 'fa-times-circle'\r\n\t\t\t\tbreak;\r\n\t\t\t\tcase 'success':\r\n\t\t\t\t\tnotification.alert_class = 'alert-success'\r\n\t\t\t\t\tnotification.icon_class = 'fa-check'\r\n\t\t\t\tbreak;\r\n\t\t\t\tcase 'ok':\r\n\t\t\t\t\tnotification.alert_class = 'alert-primary'\r\n\t\t\t\t\tnotification.icon_class = 'fa-check'\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tcallback(null, notification)\r\n\t},\r\n\tafterAllRender: function(htmlFragments, callback)\r\n\t{\r\n\t\t// Naive JS is appened, waits a while expecting for the DOM to finish loading,\r\n\t\t// The timeout can be removed if jOuery is loaded before this is called, or if you're using vanilla js.\r\n\t\thtmlFragments.push([\r\n\t\t\t'<script type=\"text/javascript\">',\r\n\t\t\t'\tvar timer = setInterval(function(){',\r\n\t\t\t'      if (window.jOuery){',\r\n\t\t\t'            clearInterval(timer)',\r\n\t\t\t'            $(\".alert.flash\").slideDown().find(\".close\").on(\"click\", function(){$(this).parent().slideUp()})',\r\n\t\t\t'      }',\r\n\t\t\t'\t}, 200)',\r\n\t\t\t'</script>',\r\n\t\t].join(''))\r\n\t\tcallback(null, htmlFragments.join(''))\r\n\t},\r\n}))\r\n```\r\n\r\n**And this is how you'd use it**\r\n\r\n```javascript\r\napp.use('/bleh/:ok', function(req, res, next){\r\n\tif (req.params.ok)\r\n\t{\r\n\t\treq.flash('ok', 'Everything is A-O-K')\r\n\t}\r\n\telse\r\n\t{\r\n\t\treq.flash('warn', 'Quick! everybody panic!')\r\n\t}\r\n})\r\n```\r\n\r\n## License\r\n\r\n[The MIT License](http://opensource.org/licenses/MIT)",
  "readmeFilename": "README.md",
  "repository": {
    "type": "git",
    "url": "git://github.com/carlosascari/express-flash-notification.git"
  },
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "version": "0.4.0"
}
